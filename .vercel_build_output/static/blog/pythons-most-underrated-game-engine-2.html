<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="description" content="" />
    <link rel="icon" href="../favicon.png" />
    <link
      href="../syntaxHighlighting.css"
      rel="stylesheet"
      type="text/css"
    />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1"
    />
    <meta http-equiv="content-security-policy" content=""><title>Blog | Konstantin Kovar</title>
	<link rel="stylesheet" href="/_app/assets/app-e93b226b.css">
	<link rel="modulepreload" href="/_app/start-f82bed3f.js">
	<link rel="modulepreload" href="/_app/chunks/index-a4305d86.js">
	<link rel="modulepreload" href="/_app/pages/__layout.svelte-54194aaf.js">
	<link rel="modulepreload" href="/_app/chunks/index-e10c4c74.js">
	<link rel="modulepreload" href="/_app/pages/blog/pythons-most-underrated-game-engine-2.md-5b21180b.js">
	<link rel="modulepreload" href="/_app/chunks/BlogPostLayout-2987b3f1.js">
	<link rel="modulepreload" href="/_app/chunks/Article-1fb784f3.js">
	<link rel="modulepreload" href="/_app/chunks/PageHeading-8fc8889e.js">
    <style>
      @font-face {
        font-family: 'Lora';
        font-style: normal;
        font-display: swap;
        font-weight: 400;
        src: local('Lora'), local('Lora Regular'),
          local('Lora-VariableFont_wght'),
          url('../static/fonts/Lora.ttf') format('ttf');
      }

      @font-face {
        font-family: 'Lora';
        font-style: italic;
        font-display: swap;
        font-weight: 400;
        src: local('Lora'), local('Lora Italic'),
          local('Lora-Italic-VariableFont_wght'),
          url('../static/fonts/Lora-Italic.ttf')
            format('ttf');
      }
    </style>
  </head>
  <body>
    <div>






<div class="min-h-[170vh]"><div class="left-0 right-0" style="position: fixed; transform: translate(0px);"><div class="relative mx-auto w-11/12 lg:w-2/3 xl:w-1/2 2xl:w-1/3">

<nav class="mx-auto mb-8 border-b-4 border-stone-700 py-4"><ul class="flex justify-around"><li><a href="/"><div class="w-36 rounded py-2 text-center transition-colors hover:bg-stone-600 hover:text-stone-200">home</div></a></li><li><a href="/blog"><div class="w-36 rounded py-2 text-center transition-colors hover:bg-stone-600 hover:text-stone-200">blog</div></a></li></ul></nav>
      



<div class="relative h-52 overflow-hidden"><div class="relative my-4 h-52 w-full text-center"><h1 class="mb-8 text-6xl">After Pong Ends</h1>
    <subtitle class="font-serif text-xl italic"></subtitle></div>
  </div>
<div class="relative h-56 bg-contain bg-center bg-no-repeat text-red-500" style="background-image: url(&#39;data:image/svg+xml;utf8,&lt;svg viewBox=&quot;0 0 250 250&quot; fill=&quot;none&quot; xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt; &lt;g stroke=&quot;currentColor&quot;&gt; &lt;path d=&quot;M25 195.048c0-.903 1.306-1.3 1.695-2.115.089-.189 1.369-2.83 1.61-2.75 1.094.365 2.962 4.112 3.611 5.111.075.114 1.354 2.037 1.445 1.916 2.428-3.238 1.174-9.757 4.138-12.72.443-.443.635 1.08.971 1.61.174.273 3.394 2.287 3.5 2.14.71-.993 1.891-7.563 4.166-6.806 1.83.61 3.845 5.96 4.25 7.5.068.257 1.16 3.788 1.556 3.472 3.122-2.498 2.886-6.793 3.61-10.416 1.227-6.133 2.111-15.104 5.083-20.553.402-.737 4.14-3.45 4.75-3.084 1.675 1.006 3.609 5.502 5.693 1.334 1.45-2.899 4.684-9.488 4.833-12.471.05-1.007.533-4.693 2.028-4.444 3.622.604 4.92 6.355 6.165 9.11 4.055 8.979 6.373 18.608 10.61 27.386 1.331 2.757 2.05 5.952 3.111 8.833.167.45 1.11 3.009 1.89 2.749 2.237-.746 3.327-9.56 4.47-11.72 6.7-12.654 11.67-26.623 16.22-40.274.284-.852.573-3.457.7-4.337.585-4.027.8-8.594 2.052-12.483.19-.594 1.195-4.368 1.94-4.301 2.59.236 1.963 5.492 3.551 6.55.152.102.77-3.646.86-4.124.462-2.42 1.331-1.368 2.316-1.368.931 0 1 3.625 1.5 4.125.7.7 2.321-.645 2.624-.088.227.415 1.594 5.43 1.875 5.36.574-.144.878-1.826 1.743-1.566.358.108 1.363 2.687 1.742 2.404.545-.41.491-2.801.728-3.485 1.22-3.54 2.552-6.904 4.036-10.366.25-.585 1.7 4.065 2.073 1.456.055-.386.126-.765.198-1.147.63-3.3.657-7.047 2.052-10.145.22-.489.567-2.543 1.08-2.713 1.18-.393 2.666 6.184 3.066 7.234.057.151.954 2.224 1.059 2.16 1.126-.675.726-2.44.683-3.484-.116-2.857-.285-5.675.177-8.513.036-.22.484-3.59.882-3.44.751.28 1.071 2.205 1.257 2.823.82 2.73 1.502 5.5 2.404 8.204 2.736 8.208 3.553 17.308 6.682 25.276.737 1.872 1.373 3.79 2.207 5.623.06.133.734 1.552.881 1.478.505-.252-.128-1.976.331-2.206.042-.02.504 1.035.573 1.125.528.679 1.061 1.343 1.522 2.073.21.332.595 1.407.595 1.015.542.902 1.038.45 1.358-.09.788-1.33.992-3.038 1.271-4.526.888-4.733 1.954-9.12 2.489-13.922.745-6.71 2.869-12.716 4.207-19.216.823-3.993.428-7.79 1.854-11.75 1.084-3.013 1.618-7.68 3.943-10.005.063-.063 1.966 5.483 2.462 5.929.719.647 1.88-2.486 2.487-1.88 1.32 1.322 1.78 4.426 2.382 6.115 1.543 4.333 2.84 8.812 4.711 13.022.025.054.427-.812.477-.921.39-.864.742-1.747 1.132-2.611.932-2.061 3.322-3.87 3.794-6.01 1.635-7.426 3.087-15.224 5.879-22.44.192-.498.968.01 1.444-.24 2.713-1.43 2.405 2.244 3.745 4.7.2.366 1.234 4.043 1.65 3.705 1.504-1.221 1.79-5.813 2.259-7.588 1.925-7.283 3.977-14.1 3.75-21.768&quot; stroke-width=&quot;8.3333&quot; stroke-miterlimit=&quot;1.5&quot; stroke-linecap=&quot;round&quot; stroke-linejoin=&quot;round&quot;&gt; &lt;/path&gt; &lt;/g&gt; &lt;/svg&gt;&#39;);"></div>


<article class="prose prose-stone mx-auto mt-4 translate-y-96 prose-code:font-mono prose-code:text-lg prose-code:font-normal before:prose-code:hidden after:prose-code:hidden xl:prose-xl 2xl:prose-2xl" style="transform: translateY(NaNpx);"><p><em>This post has been ported from the old blog and slightly edited on the 15<sup>th</sup> of May 2022.</em></p>
<p><a href="/blog/pythons-most-underrated-game-engine">“Python’s most underrated game engine for beginners”</a> is by far the most popular post on this blog and it seems to help a lot of people making their first steps with Python, so I decided to expand on this post by 1) refactoring the code to be both better and more pythonic and 2) solve the challenges I posted at the bottom of the first post utilizing the advantages of the new, refactored code.</p>
<p>For this tutorial, I will constantly refer back to the original code, so it might be helpful if you have a copy of it somewhere nearby.</p>
<p>The first thing we need to address is our Vec2 classes. We define two of them, one for normal vectors and one for normalized vectors. In most circumstances, this would be considered bad practice, because as you expand the functionality of your <code>Vec2</code> class, you also have to copy that functionality over to the <code>Vec2_norm</code> class, which isn’t very <a target="_blank" href="https://en.wikipedia.org/wiki/Don't_repeat_yourself">DRY</a>, to say the least.</p>
<p>So let’s merge these two classes into one:</p>
<pre class="language-py"><!-- HTML_TAG_START --><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Vec2</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y
        self<span class="token punctuation">.</span>magnitude <span class="token operator">=</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>x <span class="token operator">*</span> x <span class="token operator">+</span> y <span class="token operator">*</span> y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">normalized</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> Vec2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">/</span> self<span class="token punctuation">.</span>magnitude<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">/</span> self<span class="token punctuation">.</span>magnitude<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>Cool, so now we can use our <code>Vec2</code> class like we are used to and when we want to use a normalized vector we can use its <code>normalized(</code>)` method. Easy peasy.</p>
<p>Above I mentioned something about expanding our <code>Vec2</code> classes functionality. Well, what do I mean by that? After all, we have been getting by just fine with just an <code>x</code>, a <code>y</code> and a <code>magnitude</code> attribute. Now we can even normalize a vector by calling a single method, what else could we want from our class, right?</p>
<p>Consider this: How would you add two vector objects together? Probably something like this:</p>
<pre class="language-py"><!-- HTML_TAG_START --><code class="language-py">vector_1 <span class="token operator">=</span> Vec2<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
vector_2 <span class="token operator">=</span> Vec2<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span>
vector_sum <span class="token operator">=</span> Vec2<span class="token punctuation">(</span>vector_1<span class="token punctuation">.</span>x <span class="token operator">+</span> vector_2<span class="token punctuation">.</span>x<span class="token punctuation">,</span> vector_1<span class="token punctuation">.</span>y <span class="token operator">+</span> vector_2<span class="token punctuation">.</span>y<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>That’s an awful lot of code for such a simple operation though, isn’t it? Shouldn’t it be a simple as <code>vector_sum = vector_1 + vector2</code>? This is where Python’s magic methods come into play. You see, we can achieve exactly this behavior, by specifying our vector’s <code>**add**</code> method like this:</p>
<pre class="language-py"><!-- HTML_TAG_START --><code class="language-py"><span class="token keyword">def</span> <span class="token function">__add__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> Vec2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">+</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">+</span> other<span class="token punctuation">.</span>y<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>Now, whenever we use the + operator with two vector objects it will perform the addition and return a new vector object with the new values.</p>
<p>Here is a little exercise: Try and define magic methods for all the other basic arithmetic operations and when you have done that I show you my solution. The methods you are looking for are called <code>**sub**</code>, <code>**mul**</code> and <code>**truediv**</code>.</p>
<hr>
<p>Have you done it? Great. Here is what I have:</p>
<pre class="language-py"><!-- HTML_TAG_START --><code class="language-py"><span class="token keyword">class</span> <span class="token class-name">Vec2</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y
        self<span class="token punctuation">.</span>magnitude <span class="token operator">=</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>x <span class="token operator">*</span> x <span class="token operator">+</span> y <span class="token operator">*</span> y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__add__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> Vec2<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">"Only 2 Vec2 can be added to each other!"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Vec2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">+</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">+</span> other<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__sub__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> Vec2<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">"Only a Vec2 can be subtracted from another!"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Vec2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">-</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">-</span> other<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__mul__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> scalar<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>scalar<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">"A Vec2 can only be mulitplied by a scalar!"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Vec2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">*</span> scalar<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">*</span> scalar<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__truediv__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> scalar<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>scalar<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">"A Vec2 can only be divided by a scalar!"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Vec2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">/</span> scalar<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">/</span> scalar<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">normalized</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self <span class="token operator">/</span> self<span class="token punctuation">.</span>magnitude</code><!-- HTML_TAG_END --></pre>
<p>Easy right? You are probably noticing two things in my code though: Firstly, I have included checks to make sure the operators are used with the right data type since vectors can only be added to and subtracted from other vectors, yet can only be multiplied and divided by single numbers (called scalars). Secondly, I have refactored the <code>normalized()</code> method yet again to take advantage of this new functionality right away. Looking mighty fine, let’s move on.</p>
<p>Next, let’s look at our <code>HitBox</code> class. The first thing we should notice is that this class actually has no functionality at all. It consists exclusively of attributes and has no methods. Whenever you encounter a class like this, it is a perfect opportunity to refactor, since a class like this can (and should) be refactored into a collection type called <code>namedtuple</code>. So after adding the <code>from collections import namedtuple</code> statement at the top of our file, let’s refactor our HitBox to look like this: <code>HitBox = namedtuple(&quot;HitBox&quot;, &quot;x1 y1 x2 y2&quot;)</code>. Single line. Easy as pie. If something about this confuses you, check out <a href="https://docs.python.org/2/library/collections.html#collections.namedtuple">the official documentation here</a>.</p>
<p>The best part is that we can actually use this like our original <code>HitBox</code> class, so we can leave the parts of our code that used the class as they are, but not only that, since this is now a sequence type, we have now implicitly made any <code>HitBox</code> iterable. <em>“Yeah that’s nice”</em>, you might say, <em>“but when do I realistically need to iterate through the coordinates of a hitbox? That’s not very useful.”</em></p>
<p>Well, let’s take a look at the <code>draw</code> method of our original <code>App</code> class. Until now it looks like this:</p>
<pre class="language-py"><!-- HTML_TAG_START --><code class="language-py"><span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pyxel<span class="token punctuation">.</span>cls<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
    pyxel<span class="token punctuation">.</span>circ<span class="token punctuation">(</span>self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span> BALL_SIZE<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> bat <span class="token keyword">in</span> self<span class="token punctuation">.</span>bats<span class="token punctuation">:</span>
        pyxel<span class="token punctuation">.</span>rect<span class="token punctuation">(</span>bat<span class="token punctuation">.</span>hitBox<span class="token punctuation">.</span>x1<span class="token punctuation">,</span> bat<span class="token punctuation">.</span>hitBox<span class="token punctuation">.</span>y1<span class="token punctuation">,</span> bat<span class="token punctuation">.</span>hitBox<span class="token punctuation">.</span>x2<span class="token punctuation">,</span> bat<span class="token punctuation">.</span>hitBox<span class="token punctuation">.</span>y2<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
    pyxel<span class="token punctuation">.</span>text<span class="token punctuation">(</span>SCREEN_WIDTH <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> SCREEN_HEIGHT <span class="token operator">/</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>Notice how we need to reference every single coordinate when drawing a rectangle for our bats? You see, being iterable does not only mean that we can iterate through it, it also means that we can make use of Python’s very powerful packing/unpacking features. Here we can refactor the relevant line to <code>pyxel.rect(\*bat.hitBox, 7)</code>, which is way prettier and to the point.</p>
<p>For the rest of the script, the refactoring is rather unexciting, but what we definitely should do, is to move the BALL_SPEED, BALL_SIZE and BRICK_SIZE constants to where they belong: Their respective classes. You can do that yourself or copy it from below, where you find the complete script as we have it right now, just so we are on the same page:</p>
<pre class="language-py"><!-- HTML_TAG_START --><code class="language-py"><span class="token keyword">from</span> collections <span class="token keyword">import</span> namedtuple
<span class="token keyword">import</span> math
<span class="token keyword">import</span> pyxel

SCREEN_WIDTH <span class="token operator">=</span> <span class="token number">255</span>
SCREEN_HEIGHT <span class="token operator">=</span> <span class="token number">120</span>

HitBox <span class="token operator">=</span> namedtuple<span class="token punctuation">(</span><span class="token string">"HitBox"</span><span class="token punctuation">,</span> <span class="token string">"x1 y1 x2 y2"</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">Vec2</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">,</span> y<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>x <span class="token operator">=</span> x
        self<span class="token punctuation">.</span>y <span class="token operator">=</span> y
        self<span class="token punctuation">.</span>magnitude <span class="token operator">=</span> math<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>x <span class="token operator">*</span> x <span class="token operator">+</span> y <span class="token operator">*</span> y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__add__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> Vec2<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">"Only 2 Vec2 can be added to each other!"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Vec2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">+</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">+</span> other<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__sub__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> other<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>other<span class="token punctuation">,</span> Vec2<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">"Only a Vec2 can be subtracted from another!"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Vec2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">-</span> other<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">-</span> other<span class="token punctuation">.</span>y<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__mul__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> scalar<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>scalar<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">"A Vec2 can only be mulitplied by a scalar!"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Vec2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">*</span> scalar<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">*</span> scalar<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">__truediv__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> scalar<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> <span class="token keyword">not</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>scalar<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">float</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">raise</span> TypeError<span class="token punctuation">(</span><span class="token string">"A Vec2 can only be divided by a scalar!"</span><span class="token punctuation">)</span>
        <span class="token keyword">return</span> Vec2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x <span class="token operator">/</span> scalar<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">/</span> scalar<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">normalized</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> self <span class="token operator">/</span> self<span class="token punctuation">.</span>magnitude


<span class="token keyword">class</span> <span class="token class-name">Ball</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> px<span class="token punctuation">,</span> py<span class="token punctuation">,</span> vx<span class="token punctuation">,</span> vy<span class="token punctuation">,</span> speed<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>position <span class="token operator">=</span> Vec2<span class="token punctuation">(</span>px<span class="token punctuation">,</span> py<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>speed <span class="token operator">=</span> speed
        self<span class="token punctuation">.</span>size <span class="token operator">=</span> size
        self<span class="token punctuation">.</span>velocity <span class="token operator">=</span> Vec2<span class="token punctuation">(</span>vx<span class="token punctuation">,</span> vy<span class="token punctuation">)</span><span class="token punctuation">.</span>normalized<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>speed

    <span class="token keyword">def</span> <span class="token function">changeSpeedBy</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> number<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>speed <span class="token operator">*=</span> number
        self<span class="token punctuation">.</span>velocity <span class="token operator">=</span> self<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>normalized<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>speed

    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">+=</span> self<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>x
        self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">+=</span> self<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>y

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">&amp;</span>gt<span class="token punctuation">;</span><span class="token operator">=</span> SCREEN_HEIGHT <span class="token operator">-</span> self<span class="token punctuation">.</span>size<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">-</span>self<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>y

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span><span class="token operator">=</span> self<span class="token punctuation">.</span>size<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>y <span class="token operator">=</span> <span class="token operator">-</span>self<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>y


<span class="token keyword">class</span> <span class="token class-name">Bat</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> px<span class="token punctuation">,</span> py<span class="token punctuation">,</span> size<span class="token operator">=</span><span class="token number">8</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>position <span class="token operator">=</span> Vec2<span class="token punctuation">(</span>px<span class="token punctuation">,</span> py<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>velocity <span class="token operator">=</span> <span class="token number">0</span>
        self<span class="token punctuation">.</span>size <span class="token operator">=</span> size
        self<span class="token punctuation">.</span>hitBox <span class="token operator">=</span> HitBox<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">-</span> self<span class="token punctuation">.</span>size <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">-</span> self<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">+</span> self<span class="token punctuation">.</span>size <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">+</span> self<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">+=</span> self<span class="token punctuation">.</span>velocity
        self<span class="token punctuation">.</span>hitBox <span class="token operator">=</span> HitBox<span class="token punctuation">(</span>
            self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">-</span> self<span class="token punctuation">.</span>size <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">-</span> self<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">+</span> self<span class="token punctuation">.</span>size <span class="token operator">/</span> <span class="token number">4</span><span class="token punctuation">,</span>
            self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">+</span> self<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
        <span class="token punctuation">)</span>

        <span class="token keyword">if</span> pyxel<span class="token punctuation">.</span>btnp<span class="token punctuation">(</span>pyxel<span class="token punctuation">.</span>KEY_W<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>velocity <span class="token operator">=</span> <span class="token operator">-</span><span class="token number">2</span>

        <span class="token keyword">if</span> pyxel<span class="token punctuation">.</span>btnp<span class="token punctuation">(</span>pyxel<span class="token punctuation">.</span>KEY_S<span class="token punctuation">)</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>velocity <span class="token operator">=</span> <span class="token number">2</span>

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">-</span> self<span class="token punctuation">.</span>size <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span> <span class="token number">0</span><span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> self<span class="token punctuation">.</span>size
            self<span class="token punctuation">.</span>velocity <span class="token operator">=</span> <span class="token number">0</span>

        <span class="token keyword">if</span> self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">+</span> self<span class="token punctuation">.</span>size <span class="token operator">&amp;</span>gt<span class="token punctuation">;</span> SCREEN_HEIGHT<span class="token punctuation">:</span>
            self<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">=</span> SCREEN_HEIGHT <span class="token operator">-</span> self<span class="token punctuation">.</span>size
            self<span class="token punctuation">.</span>velocity <span class="token operator">=</span> <span class="token number">0</span>


<span class="token keyword">class</span> <span class="token class-name">App</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        pyxel<span class="token punctuation">.</span>init<span class="token punctuation">(</span>SCREEN_WIDTH<span class="token punctuation">,</span> SCREEN_HEIGHT<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ball <span class="token operator">=</span> Ball<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>score <span class="token operator">=</span> <span class="token number">0</span>
        pyxel<span class="token punctuation">.</span>run<span class="token punctuation">(</span>self<span class="token punctuation">.</span>update<span class="token punctuation">,</span> self<span class="token punctuation">.</span>draw<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> pyxel<span class="token punctuation">.</span>btnp<span class="token punctuation">(</span>pyxel<span class="token punctuation">.</span>KEY_Q<span class="token punctuation">)</span><span class="token punctuation">:</span>
            pyxel<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">&amp;</span>gt<span class="token punctuation">;</span><span class="token operator">=</span> SCREEN_WIDTH <span class="token operator">-</span> self<span class="token punctuation">.</span>size<span class="token punctuation">:</span>
            pyxel<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span><span class="token operator">=</span> self<span class="token punctuation">.</span>size<span class="token punctuation">:</span>
            pyxel<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        pyxel<span class="token punctuation">.</span>cls<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        pyxel<span class="token punctuation">.</span>circ<span class="token punctuation">(</span>self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span> self<span class="token punctuation">.</span>size<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
        pyxel<span class="token punctuation">.</span>text<span class="token punctuation">(</span>SCREEN_WIDTH <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> SCREEN_HEIGHT <span class="token operator">/</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>


<span class="token keyword">class</span> <span class="token class-name">App</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        pyxel<span class="token punctuation">.</span>init<span class="token punctuation">(</span>SCREEN_WIDTH<span class="token punctuation">,</span> SCREEN_HEIGHT<span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ball <span class="token operator">=</span> Ball<span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">20</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>bats <span class="token operator">=</span> <span class="token punctuation">[</span>Bat<span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Bat<span class="token punctuation">(</span>SCREEN_WIDTH <span class="token operator">-</span> <span class="token number">10</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">]</span>
        self<span class="token punctuation">.</span>score <span class="token operator">=</span> <span class="token number">0</span>
        pyxel<span class="token punctuation">.</span>run<span class="token punctuation">(</span>self<span class="token punctuation">.</span>update<span class="token punctuation">,</span> self<span class="token punctuation">.</span>draw<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">update</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">if</span> pyxel<span class="token punctuation">.</span>btnp<span class="token punctuation">(</span>pyxel<span class="token punctuation">.</span>KEY_Q<span class="token punctuation">)</span><span class="token punctuation">:</span>
            pyxel<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> bat <span class="token keyword">in</span> self<span class="token punctuation">.</span>bats<span class="token punctuation">:</span>
            bat<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span>
                bat<span class="token punctuation">.</span>hitBox<span class="token punctuation">.</span>x1 <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span> bat<span class="token punctuation">.</span>hitBox<span class="token punctuation">.</span>x2
                <span class="token keyword">and</span> bat<span class="token punctuation">.</span>hitBox<span class="token punctuation">.</span>y1 <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span> bat<span class="token punctuation">.</span>hitBox<span class="token punctuation">.</span>y2
            <span class="token punctuation">)</span><span class="token punctuation">:</span>
                self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>x <span class="token operator">=</span> <span class="token operator">-</span>self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>x
                self<span class="token punctuation">.</span>score <span class="token operator">+=</span> <span class="token number">1</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">&amp;</span>gt<span class="token punctuation">;</span><span class="token operator">=</span> SCREEN_WIDTH <span class="token operator">-</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>size<span class="token punctuation">:</span>
            pyxel<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x <span class="token operator">&amp;</span>lt<span class="token punctuation">;</span><span class="token operator">=</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>size<span class="token punctuation">:</span>
            pyxel<span class="token punctuation">.</span>quit<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        pyxel<span class="token punctuation">.</span>cls<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>
        pyxel<span class="token punctuation">.</span>circ<span class="token punctuation">(</span>self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>size<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
        <span class="token keyword">for</span> bat <span class="token keyword">in</span> self<span class="token punctuation">.</span>bats<span class="token punctuation">:</span>
            pyxel<span class="token punctuation">.</span>rect<span class="token punctuation">(</span><span class="token operator">*</span>bat<span class="token punctuation">.</span>hitBox<span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>
        pyxel<span class="token punctuation">.</span>text<span class="token punctuation">(</span>SCREEN_WIDTH <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> SCREEN_HEIGHT <span class="token operator">/</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">7</span><span class="token punctuation">)</span>


App<span class="token punctuation">(</span><span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>Now that we have a much better version of the original code, let’s try and implement the improvements I was suggesting at the end of the first post, these were:</p>
<ul><li>To make the game less predictable, let’s change the ball’s angle by which he bounces back from the bat by a small random value. Hint: you will probably want to `from random import uniform for this one.<ul><li>More advanced: Make the angle change based on the position of the ball relative to the position of the bat at the time of contact.</li></ul></li>
<li>Make the game harder as it goes along, maybe increase the ball speed a little every 5 points (it isn’t technically necessary, but it would be good practice to rename the <code>BALL_SPEED</code> variable to <code>ball_speed</code>, since all-cap variable names generally indicate constants).</li>
<li>Use different color schemes. Maybe even change colors dynamically throughout the game (to indicate an increase in ball speed for example).</li>
<li>There is a bug, that when the ball enters the bat from the bottom or top rather than the side, it will get kind of stuck there, maybe you can figure out what the problem is and fix it?</li></ul>
<h2>Change the balls angle based on the position of the ball relative to the position of the bat at the time of contact</h2>
<p>Let’s just go for the more advanced version right away. First, let’s clarify what we mean by “angle” and what we mean by “relative to” in terms of our code. When we say “angle, we mean that not only the x-attribute of our balls velocity vector changes but also the y-attribute. When we say “relative to” we mean to compare the ball’s y-position with the bat’s y-position.</p>
<p>Let’s start looking at our code. We check for the collision between ball and bat starting on line 113 inside our <code>App</code>’s <code>update</code> method. Instead of just reversing the direction of the ball on the x-axis like we are doing right now, let’s also play with the y-value of the velocity vector.</p>
<p>The problem here is that this can become messy since we have lots of cases we want to avoid. We don’t want to make it so big for example, that the ball is just moving in a straight vertical line, we also don’t want it to lock in to just go perfectly horizontal near the edge of the screen forever (which could potentially happen). Put aptly, we want to keep control over the range of acceptable y-values. In other words: We want to keep the ball from getting crazy.</p>
<p>Here is how I would go about this. Knowing that this can get messy, I will not attempt to edit the code right then and there, but rather define its own function for this behavior.</p>
<p>The idea is this: We take in a value I’m calling offset, which is what determines how much the value should be changed. Then I’m also defining a range of inputs (minimum and maximum value of the offset) and a range of outputs (this is how I keep control over what I want to allow). Then I am mapping my range of inputs to the range of outputs and translate my offset to fit the mapping. Phu, that was a lot, let’s see it in action:</p>
<pre class="language-py"><!-- HTML_TAG_START --><code class="language-py"><span class="token keyword">def</span> <span class="token function">mutate_y_value</span><span class="token punctuation">(</span>offset<span class="token punctuation">,</span> min_input<span class="token punctuation">,</span> max_input<span class="token punctuation">,</span> min_output<span class="token punctuation">,</span> max_output<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment"># determining the size of each range</span>
    offset_range <span class="token operator">=</span> max_offset <span class="token operator">-</span> min_offset
    output_range <span class="token operator">=</span> max_output <span class="token operator">-</span> min_output

    <span class="token comment"># converting the offset_range to a range 0-1</span>

offset_scaled <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>offset <span class="token operator">-</span> min_offset<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span>offset_range<span class="token punctuation">)</span>

    <span class="token comment"># returning the mapped value</span>
    <span class="token keyword">return</span> min_output <span class="token operator">+</span> <span class="token punctuation">(</span>offset_scaled <span class="token operator">*</span> output_range<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>This would work, but writing a function like this could be considered bad practice. Functionality like this should be encapsulated by the entity it belongs to. I would argue this functionality belongs to our <code>Vec2</code> class. Rewritten as a method of the <code>Vec2</code> class, it now looks like this:</p>
<pre class="language-py"><!-- HTML_TAG_START --><code class="language-py"><span class="token keyword">def</span> <span class="token function">mutate_y_value_in_range</span><span class="token punctuation">(</span>
    self<span class="token punctuation">,</span> offset<span class="token punctuation">,</span> min_offset<span class="token punctuation">,</span> max_offset<span class="token punctuation">,</span> min_output<span class="token punctuation">,</span> max_output
<span class="token punctuation">)</span><span class="token punctuation">:</span>
    offset_range <span class="token operator">=</span> max_offset <span class="token operator">-</span> min_offset
    output_range <span class="token operator">=</span> max_output <span class="token operator">-</span> min_output

    offset_scaled <span class="token operator">=</span> <span class="token builtin">float</span><span class="token punctuation">(</span>offset <span class="token operator">-</span> min_offset<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token builtin">float</span><span class="token punctuation">(</span>offset_range<span class="token punctuation">)</span>

    <span class="token keyword">return</span> Vec2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>x<span class="token punctuation">,</span> self<span class="token punctuation">.</span>y <span class="token operator">+</span> min_output <span class="token operator">+</span> <span class="token punctuation">(</span>offset_scaled <span class="token operator">*</span> output_range<span class="token punctuation">)</span><span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>Notice how I have added the <code>self</code> argument and how I am utilizing it to return a new vector object, to make its application easier.</p>
<p>So how do we apply this function? In our App’s update method, between reversing the ball’s velocity’s x-value, and incrementing the score, we call our new method:</p>
<pre class="language-py"><!-- HTML_TAG_START --><code class="language-py">self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>velocity <span class="token operator">=</span> <span class="token punctuation">(</span>
    self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>mutate_y_value_in_range<span class="token punctuation">(</span>
        <span class="token punctuation">(</span>self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y <span class="token operator">-</span> bat<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">)</span><span class="token punctuation">,</span>
        <span class="token operator">-</span>bat<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
        bat<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
        <span class="token operator">-</span><span class="token number">1.5</span><span class="token punctuation">,</span>
        <span class="token number">1.5</span><span class="token punctuation">,</span>
     <span class="token punctuation">)</span><span class="token punctuation">.</span>normalized<span class="token punctuation">(</span><span class="token punctuation">)</span>
     <span class="token operator">*</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>speed
<span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<p>Here we assign a new vector to <code>self.ball.velocity</code>. Keep in mind the x-value has already been reversed. The first argument here is the difference between the ball’s y-position and the bat’s y-position. The <code>min_offset</code> and <code>max_offset</code> arguments cannot possibly be bigger than the size of the bats (because in that case, they would not touch the bat). The output I determined by just playing around a little. The bigger the range the sharper the angle. Whatever feels right. I went for 1.5. Time to give it a test run, maybe take a break, and move on.</p>
<h2>Increase the ball speed a little every 5 points</h2>
<p>If you powered through until this point you are beyond the level where I need to explain this one, so I’m just pasting the code here.</p>
<pre class="language-py"><!-- HTML_TAG_START --><code class="language-py">self<span class="token punctuation">.</span>score <span class="token operator">+=</span> <span class="token number">1</span>                 <span class="token comment"># this line already exists</span>
<span class="token keyword">if</span> self<span class="token punctuation">.</span>score <span class="token operator">%</span> <span class="token number">5</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">:</span>
    self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>speed <span class="token operator">+=</span> <span class="token number">1</span>
    self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>velocity <span class="token operator">=</span> <span class="token punctuation">(</span>
        self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>velocity<span class="token punctuation">.</span>normalized<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>speed
    <span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre>
<h2>Use different color schemes. Maybe even change colors dynamically throughout the game</h2>
<p>Let’s use the same <code>if</code> statement for this one, but before we do that we have to substitute all the colors we are using right now with variables we can change dynamically. Right now, we are using two different colors, a foreground color for the ball the bats and the text and a background color to fill out the window. So let’s define it this way: At the top of the file, create a dictionary to hold that information with something like <code>colors = dict(foreground=7, background=0)</code>. Luckily, we only use colors in our <code>App</code>’s <code>draw</code> method, so we don’t have to search the whole file to replace colors. After replacing these values the <code>draw</code> method should look like this:</p>
<pre class="language-py"><!-- HTML_TAG_START --><code class="language-py"><span class="token keyword">def</span> <span class="token function">draw</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
    pyxel<span class="token punctuation">.</span>cls<span class="token punctuation">(</span>colors<span class="token punctuation">[</span><span class="token string">"background"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    pyxel<span class="token punctuation">.</span>circ<span class="token punctuation">(</span>
        self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>x<span class="token punctuation">,</span>
        self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>position<span class="token punctuation">.</span>y<span class="token punctuation">,</span>
        self<span class="token punctuation">.</span>ball<span class="token punctuation">.</span>size<span class="token punctuation">,</span>
        colors<span class="token punctuation">[</span><span class="token string">"foreground"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">)</span>
    <span class="token keyword">for</span> bat <span class="token keyword">in</span> self<span class="token punctuation">.</span>bats<span class="token punctuation">:</span>
        pyxel<span class="token punctuation">.</span>rect<span class="token punctuation">(</span><span class="token operator">*</span>bat<span class="token punctuation">.</span>hitBox<span class="token punctuation">,</span> colors<span class="token punctuation">[</span><span class="token string">"foreground"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    pyxel<span class="token punctuation">.</span>text<span class="token punctuation">(</span>
        SCREEN_WIDTH <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">,</span> SCREEN_HEIGHT <span class="token operator">/</span> <span class="token number">12</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>score<span class="token punctuation">)</span><span class="token punctuation">,</span> colors<span class="token punctuation">[</span><span class="token string">"foreground"</span><span class="token punctuation">]</span>
    <span class="token punctuation">)</span></code><!-- HTML_TAG_END --></pre></article></div>
    <footer class="mt-8 h-4 border-t-2 border-stone-600 pt-4 text-center font-serif text-xs text-stone-600"><p>I am keeping all the cookies to myself and you can&#39;t
    have <span class="underline">any</span>.
  </p>
  <p>This website uses <a target="_blank" href="https://www.goatcounter.com/">a very privacy aware analytics tool</a>.
  </p>
  <p class="mb-4">Do something nice today.</p></footer></div></div>


		<script type="module" data-hydrate="55no4m">
		import { start } from "/_app/start-f82bed3f.js";
		start({
			target: document.querySelector('[data-hydrate="55no4m"]').parentNode,
			paths: {"base":"","assets":""},
			session: {},
			route: true,
			spa: false,
			trailing_slash: "never",
			hydrate: {
				status: 200,
				error: null,
				nodes: [
					import("/_app/pages/__layout.svelte-54194aaf.js"),
						import("/_app/pages/blog/pythons-most-underrated-game-engine-2.md-5b21180b.js")
				],
				params: {},
				routeId: "blog/pythons-most-underrated-game-engine-2"
			}
		});
	</script></div>
    <script
      defer
      data-goatcounter="https://neugierdsnase.goatcounter.com/count"
      async
      src="//gc.zgo.at/count.js"
    ></script>
  </body>
</html>
